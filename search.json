[{"title":"CP-ABE","url":"/2025/05/25/2025/CP-ABE/","content":"\n## 密文策略属性基加密（CP-ABE, Cipher-Policy Attribute-Based Encryption）\n\nCP-ABE 的核心是密文与访问策略相关联，私钥与属性相关联。\n\n1. $(pk, msk) \\leftarrow \\text{Setup}(1^{\\lambda})$\n\n**执行对象：KGC**\n\n**本质：系统参数初始化**\n\n运行 $\\text{GroupGen}(1^{\\lambda})$ 生成群参数: $par := (p, e, G_1, G_2, G_T, g_1, g_2)$\n\n随机选择一个整数 $\\alpha \\leftarrow \\mathbb{Z}_p$ 和抗碰撞哈希函数 $H: \\{0, 1\\}^* \\rightarrow G_2$。 计算公钥 $pk$ 和主私钥 $msk$ :\n\n$$\npk = (par, H, e(g_1, g_2)^{\\alpha}), \\quad msk = \\alpha\n$$\n\n\n2. $(tk, sk) \\leftarrow \\text{KeyGen}(pk, msk, \\mathcal{S} = \\{u_i\\}_{i \\in [m]}) $\n\n**执行对象：KGC**\n\n**本质：基于属性集，为用户生成转换密钥（给区块链）和解密密钥（给用户）**\n\n随机选择整数 $r \\leftarrow \\mathbb{Z}_p$, $\\beta \\leftarrow \\mathbb{Z}_p$计算:\n$$\ntk_0 = g_2^{\\frac{\\alpha + r}{\\beta}}, \\quad tk_1 = g_1^{\\frac{r}{\\beta}}, \\quad tk_{2, i} = H(u_i)^{\\frac{r}{\\beta}} \\\\\nsk = \\beta\n$$\n输出 $(tk = (\\mathcal{S}, tk_0, tk_1, \\{tk_{2, i}\\}_{i \\in [m]}), sk)$\n\n\n\n3. $C \\leftarrow \\text{Enc}(pk, \\mathbb{S} = (M, \\pi, \\{\\pi(i)\\}_{i \\in [\\ell]}), msg)$\n\n**执行对象：数据所有者**\n\n**本质：指定访问策略，加密消息**\n\n选择一个秘密值 $s \\leftarrow \\mathbb{Z}_p$，随机生成向量 $v \\leftarrow \\mathbb{Z}_p^{n-1}$ ，计算 $\\lambda_{i}= M_i(s \\| v)^\\top$。随机选择 $t_{1}, t_{2},\\cdots,t_\\ell\\in\\mathbb{Z}_p$ ，再计算:\n$$\nct_{0, i} = g_{1}^{t_{i}}, \\quad  ct_{1, i} = g_{2}^{\\lambda_{i}} \\cdot H(\\pi(i))^{-t_{i}}, \\quad ct_2 = g_1^s, \\quad ct_3 = msg \\cdot e(g_1, g_2)^{\\alpha s}\n$$\n输出 $C = (\\mathbb{S}, \\{ct_{0, i}, ct_{1, i}\\}_{i \\in [\\ell]}, ct_2, ct_3)$\n\n**按需求打上时间戳，即添加一个 $time$**\n\n\n\n4. $\\text{PTC} / \\bot \\leftarrow \\text{PDec}(ct, tk)$\n\n**执行对象：区块链**\n\n**本质：取消访问控制层，实现外包部分解密**\n\n使用转换密钥 $tk$ ，如果 $\\mathcal{S}$ 满足访问控制策略 $\\mathbb{S}$，则存在一个常数集 $\\{\\omega_i\\}_{i \\in I}$ 满足条件 $\\sum_{i \\in I} \\omega_iM_i = (1, 0, \\ldots, 0)$ ，并计算如下式子得到:\n$$\n\\begin{align*}\nptc_{0} &= \\frac{e(ct_2,tk_0)}\n            {\\prod_{i\\in I}\\left(e(ct_{1, i},tk_1) \\cdot e(ct_{0, i},tk_{2, i}\\right)^{\\omega_i}} \\\\\n            \n\t&= \\frac{e(g_{1}^{s},g_2^{\\frac{\\alpha + r}{\\beta}})}\n\t\t\t{\\prod_{i\\in I}\\left(e(g_{2}^{\\lambda_{i}} \\cdot H(u_i)^{-t_{i}}, g_1^{\\frac{r}{\\beta}}) \\cdot e(g_{1}^{t_{i}}, H(u_i)^{\\frac{r}{\\beta}}) \\right)^{\\omega_i}} \\\\\n\t\t\t\n\t&= \\frac{e(g_{1},g_{2})^{\\frac{\\alpha s}{\\beta}} \\cdot e(g_1,g_2)^{\\frac{r s}{\\beta}}}\n\t\t\t{\\prod_{i\\in I}\\left(e(g_{2}^{\\lambda_{i}}, g_1^{\\frac{r}{\\beta}}) \\cdot e(H(u_i)^{-t_{i}}, g_1^{\\frac{r}{\\beta}}) \\cdot e(g_{1}^{t_{i}}, H(u_i)^{\\frac{r}{\\beta}}) \\right)^{\\omega_i}} \\\\\n\t\t\t\n\t&= \\frac{e(g_{1},g_{2})^{\\frac{\\alpha s}{\\beta}} \\cdot e(g_1,g_2)^{\\frac{r s}{\\beta}}}\n\t\t\t{\\prod_{i\\in I}\\left(e(g_1,g_2)^{\\frac{\\lambda_i r}{\\beta}}\\right)^{\\omega_i}} \\\\\n\t\t\t\n\t&= \\frac{e(g_{1},g_{2})^{\\frac{\\alpha s}{\\beta}} \\cdot e(g_1,g_2)^{\\frac{r s}{\\beta}}}\n\t\t\t{e(g_1, g_2)^{\\frac{r}{\\beta} \\cdot \\sum_{i\\in I}\\omega_i\\lambda_i}}\\\\\n\t\t\t\n\t&= \\frac{e(g_{1},g_{2})^{\\frac{\\alpha s}{\\beta}} \\cdot e(g_1,g_2)^{\\frac{r s}{\\beta}}}\n\t\t\t{e(g_1, g_2)^{\\frac{r s}{\\beta}}} \\\\\n\t\t\t\n\t&= e(g_{1},g_{2})^{\\frac{\\alpha s}{\\beta}} \\\\ \\\\\n\t\n\t\nptc_{1} &=  ct_3\n\\end{align*}\n$$\n\n\n5. $msg / \\bot \\leftarrow \\text{TDec}(\\text{PTC}, sk)$\n\n**执行对象：数据获取者**\n\n**本质：解密获取明文消息**\n\n使用私钥 $sk = \\beta$重构消息 $msg$ 通过计算： \n$$\n\\begin{align*}\nmsg  &= ptc_1 / (ptc_0)^{\\beta} \\\\\n     &= \\frac{msg \\cdot e(g_1, g_2)^{\\alpha s}}{(e(g_{1},g_{2})^{\\frac{\\alpha s}{\\beta}})^{\\beta}} \\\\\n\\end{align*}\n$$\n\n","categories":["专业学习"]},{"title":"KP-ABE","url":"/2025/05/25/2025/KP-ABE/","content":"\n## 密钥策略属性基加密（KP-ABE, Key-Policy Attribute-Based Encryption）\n\nKP-ABE 的核心特性在于访问策略由密钥携带，而非密文。\n\n1. $(pk, msk) \\leftarrow \\text{Setup}(1^{\\lambda})$\n\n   KGC 运行 $\\text{GroupGen}(1^{\\lambda})$ 生成群参数 $par := (p, e, G_1, G_2, G_T, g_1, g_2)$\n\n   随机选择一个整数 $\\alpha \\leftarrow \\mathbb{Z}_p$ 和抗碰撞哈希函数 $H: \\{0, 1\\}^* \\rightarrow G_1$.。计算公钥 $pk$ 和主私钥 $msk$ :\n\n   $pk = (par, H, e(g_1, g_2)^{\\alpha}), \\quad msk = \\alpha.$\n\n2. $sk \\leftarrow \\text{KeyGen}(pk, msk, \\mathcal{S} = (M, \\pi, \\{p(i)\\}_{i \\in [\\ell]}))$\n\n   Data user 随机选择整数 $r \\leftarrow \\mathbb{Z}_p$, $v \\leftarrow \\mathbb{Z}_p^{n-1}$，计算:\n\n   $sk_1 = g_2^r, \\quad sk_{2, i} = g_1^{M_i(\\alpha \\| v)^\\top} \\cdot H(\\pi(i))^{r}$\n\n   输出 $sk = (\\mathcal{S}, sk_1, \\{sk_{2, i}\\}_{i \\in [\\ell]})$.\n\n3. $\\text{ct} \\leftarrow \\text{Enc}(pk, \\mathbb{S} = \\{u_i\\}_{i \\in [m]}, msg)$\n\n   Data owner 随机生成一个秘密值 $s \\leftarrow \\mathbb{Z}_p$， 计算:\n\n   $ct_{1, i} = H(u_i)^s, \\quad ct_2 = g_2^s, \\quad ct_3 = msg \\cdot e(g_1, g_2)^{\\alpha s}$\n\n   输出 $ct = (\\mathbb{S}, \\{ct_{1, i}\\}_{i \\in [m]}, ct_2, ct_3)$.\n\n4. $msg / \\bot \\leftarrow \\text{Dec}(ct, sk)$\n\n   如果 $\\mathcal{S}$ 满足访问控制策略 $\\mathbb{S}$，则存在一个常数集 $\\{\\gamma_i\\}_{i \\in I}$ 满足条件 $\\sum_{i \\in I} \\gamma_i M_i = (1, 0, \\ldots, 0)$ 重构消息 $msg$，通过计算:\n\n\n$$\nmsg = \\frac{e\\left(\\prod_{i \\in I} (ct_{1, \\pi(i)})^{\\gamma_i}, sk_1\\right) \\cdot ct_3}{e\\left(\\prod_{i \\in I} (sk_{2, i})^{\\gamma_i}, ct_2\\right)}\n$$\n","tags":["访问控制","属性基加密"],"categories":["专业学习"]},{"title":"你好世界","url":"/2023/12/25/2025/hello-world/","content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n","categories":["随笔杂谈"]}]